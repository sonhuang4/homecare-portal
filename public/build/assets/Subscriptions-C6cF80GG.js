import{u as B,r as p,j as e,S as d,t as g}from"./app-DKA_wRZs.js";import{A as D}from"./AdminLayout-CY3Fnkm9.js";function $({auth:b,subscriptions:n=[],filters:r={},stats:a={}}){const{success:j,error:f,info:U}=B(),[l,o]=p.useState([]),[v,x]=p.useState(!1),N=(t,s)=>{const i=new URLSearchParams(window.location.search);s==="all"||s===""?i.delete(t):i.set(t,s),d.get(`/admin/subscriptions?${i.toString()}`,{},{preserveState:!0,preserveScroll:!0})},w=t=>{const s=new URLSearchParams(window.location.search);t===""?s.delete("search"):s.set("search",t),d.get(`/admin/subscriptions?${s.toString()}`,{},{preserveState:!0,preserveScroll:!0})},y=t=>{o(s=>{const i=s.includes(t)?s.filter(h=>h!==t):[...s,t];return x(i.length>0),i})},k=()=>{const t=n.map(s=>s.id);o(l.length===t.length?[]:t),x(l.length!==t.length)},S=t=>({active:"bg-green-500/20 border-green-500/30 text-green-400",canceled:"bg-red-500/20 border-red-500/30 text-red-400",incomplete:"bg-yellow-500/20 border-yellow-500/30 text-yellow-400",incomplete_expired:"bg-orange-500/20 border-orange-500/30 text-orange-400",past_due:"bg-red-500/20 border-red-500/30 text-red-400",trialing:"bg-blue-500/20 border-blue-500/30 text-blue-400",unpaid:"bg-gray-500/20 border-gray-500/30 text-gray-400"})[t]||"bg-gray-500/20 border-gray-500/30 text-gray-400",C=t=>({active:"✅",canceled:"❌",incomplete:"⏳",incomplete_expired:"🔴",past_due:"⚠️",trialing:"🆓",unpaid:"💸"})[t]||"❓",_=t=>({price_basic:"bg-blue-500/20 border-blue-500/30 text-blue-400",price_premium:"bg-purple-500/20 border-purple-500/30 text-purple-400",price_pro:"bg-gold-500/20 border-gold-500/30 text-yellow-400"})[t]||"bg-gray-500/20 border-gray-500/30 text-gray-400",L=t=>new Date(t).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),P=t=>({price_basic:"Basic Plan",price_premium:"Premium Plan",price_pro:"Professional Plan"})[t]||t||"Unknown Plan",M=()=>{l.length!==0&&confirm(`Are you sure you want to cancel ${l.length} subscriptions?`)&&d.patch("/admin/subscriptions/bulk-cancel",{subscription_ids:l},{onSuccess:()=>{j(`${l.length} subscriptions cancelled successfully`),o([]),x(!1)},onError:()=>{f("Failed to cancel subscriptions")}})},c=n.filter(t=>{if(r.status&&r.status!=="all"&&t.stripe_status!==r.status)return!1;if(r.search){const s=r.search.toLowerCase();return t.user.name.toLowerCase().includes(s)||t.user.email.toLowerCase().includes(s)||t.price_id.toLowerCase().includes(s)}return!0});return e.jsx(D,{title:"Subscription Management - NWB Admin",auth:b,children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"relative overflow-hidden rounded-3xl",style:{background:"linear-gradient(135deg, rgba(0, 179, 186, 0.1) 0%, rgba(0, 179, 186, 0.05) 100%)"},children:[e.jsx("div",{className:"absolute inset-0 opacity-10",children:e.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 rounded-full filter blur-3xl",style:{backgroundColor:"#00b3ba"}})}),e.jsx("div",{className:"relative p-8",children:e.jsx("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:e.jsxs("div",{children:[e.jsxs("h2",{className:"text-4xl font-bold text-white mb-3 flex items-center",children:[e.jsx("span",{className:"mr-4 text-5xl",children:"💳"}),"Subscription Management"]}),e.jsx("p",{className:"text-xl text-slate-300 mb-2",children:"Monitor and manage all client subscriptions and billing"}),e.jsx("p",{className:"text-sm font-medium",style:{color:"#00b3ba"},children:"Admin Dashboard • Subscription Management • Billing System"})]})})})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-6 gap-4",children:[e.jsxs("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl p-4 border border-white/20 text-center hover:bg-white/15 transition-all",children:[e.jsx("div",{className:"text-2xl font-bold text-white",children:a.total||n.length}),e.jsx("div",{className:"text-gray-300 text-sm",children:"Total Subscriptions"})]}),e.jsxs("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl p-4 border border-white/20 text-center hover:bg-white/15 transition-all",children:[e.jsx("div",{className:"text-2xl font-bold text-green-400",children:a.active||n.filter(t=>t.stripe_status==="active").length}),e.jsx("div",{className:"text-gray-300 text-sm",children:"Active"})]}),e.jsxs("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl p-4 border border-white/20 text-center hover:bg-white/15 transition-all",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-400",children:a.trialing||n.filter(t=>t.stripe_status==="trialing").length}),e.jsx("div",{className:"text-gray-300 text-sm",children:"Trialing"})]}),e.jsxs("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl p-4 border border-white/20 text-center hover:bg-white/15 transition-all",children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-400",children:a.incomplete||n.filter(t=>t.stripe_status==="incomplete").length}),e.jsx("div",{className:"text-gray-300 text-sm",children:"Incomplete"})]}),e.jsxs("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl p-4 border border-white/20 text-center hover:bg-white/15 transition-all",children:[e.jsx("div",{className:"text-2xl font-bold text-orange-400",children:a.past_due||n.filter(t=>t.stripe_status==="past_due").length}),e.jsx("div",{className:"text-gray-300 text-sm",children:"Past Due"})]}),e.jsxs("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl p-4 border border-white/20 text-center hover:bg-white/15 transition-all",children:[e.jsx("div",{className:"text-2xl font-bold text-red-400",children:a.canceled||n.filter(t=>t.stripe_status==="canceled").length}),e.jsx("div",{className:"text-gray-300 text-sm",children:"Canceled"})]})]}),e.jsx("div",{className:"bg-white/10 backdrop-blur-lg rounded-2xl p-6 border border-white/20",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-white mb-2",children:"Search Subscriptions"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),e.jsx("input",{type:"text",placeholder:"Search by client name, email, plan...",defaultValue:r.search||"",onChange:t=>{clearTimeout(window.searchTimeout),window.searchTimeout=setTimeout(()=>{w(t.target.value)},300)},className:"w-full pl-10 px-3 py-2 bg-[#232424] border border-white/30 rounded-lg text-white placeholder-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-white mb-2",children:"Status"}),e.jsxs("select",{value:r.status||"all",onChange:t=>N("status",t.target.value),className:"w-full px-3 py-2 bg-[#232424] border border-white/30 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"active",children:"✅ Active"}),e.jsx("option",{value:"trialing",children:"🆓 Trialing"}),e.jsx("option",{value:"incomplete",children:"⏳ Incomplete"}),e.jsx("option",{value:"past_due",children:"⚠️ Past Due"}),e.jsx("option",{value:"canceled",children:"❌ Canceled"}),e.jsx("option",{value:"unpaid",children:"💸 Unpaid"})]})]}),e.jsx("div",{className:"flex items-end",children:e.jsxs("button",{onClick:()=>d.get("/admin/subscriptions"),className:"w-full bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-lg transition-all flex items-center justify-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})}),"Clear Filters"]})})]})}),v&&e.jsx("div",{className:"bg-yellow-500/10 border border-yellow-500/20 rounded-2xl p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-yellow-300 font-medium flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),l.length," subscriptions selected"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:M,className:"bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg text-sm transition-all",children:"Cancel Selected"}),e.jsx("button",{onClick:()=>{o([]),x(!1)},className:"bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-lg text-sm transition-all",children:"Clear Selection"})]})]})}),e.jsx("div",{className:"bg-white/10 backdrop-blur-lg rounded-2xl border border-white/20 overflow-hidden",children:c&&c.length>0?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-white/10",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4 text-left",children:e.jsx("input",{type:"checkbox",checked:l.length===c.length&&c.length>0,onChange:k,className:"rounded border-gray-300 bg-[#232424]"})}),e.jsx("th",{className:"px-6 py-4 text-left text-sm font-medium text-gray-300",children:"ID"}),e.jsx("th",{className:"px-6 py-4 text-left text-sm font-medium text-gray-300",children:"Client Details"}),e.jsx("th",{className:"px-6 py-4 text-left text-sm font-medium text-gray-300",children:"Plan"}),e.jsx("th",{className:"px-6 py-4 text-left text-sm font-medium text-gray-300",children:"Status"}),e.jsx("th",{className:"px-6 py-4 text-left text-sm font-medium text-gray-300",children:"Start Date"}),e.jsx("th",{className:"px-6 py-4 text-left text-sm font-medium text-gray-300",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-white/10",children:c.map(t=>{var s,i,h,m,u;return e.jsxs("tr",{className:"hover:bg-white/5 transition-colors",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsx("input",{type:"checkbox",checked:l.includes(t.id),onChange:()=>y(t.id),className:"rounded border-gray-300 bg-[#232424]"})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"text-white font-medium",children:["#",t.id]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-r from-blue-600 to-purple-600 flex items-center justify-center text-white font-bold text-sm mr-3",children:((h=(i=(s=t.user)==null?void 0:s.name)==null?void 0:i.charAt(0))==null?void 0:h.toUpperCase())||"U"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-white font-medium text-sm",children:((m=t.user)==null?void 0:m.name)||"Unknown User"}),e.jsx("div",{className:"text-gray-400 text-xs",children:(u=t.user)==null?void 0:u.email})]})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-xs font-medium border ${_(t.price_id)}`,children:["💳 ",P(t.price_id)]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-xs font-medium border ${S(t.stripe_status)}`,children:[e.jsx("span",{className:"mr-1",children:C(t.stripe_status)}),t.stripe_status.replace("_"," ").toUpperCase()]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("div",{className:"text-white text-sm",children:L(t.created_at)})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(g,{href:`/admin/subscriptions/${t.id}`,className:"text-blue-400 hover:text-blue-300 text-sm font-medium transition-colors",title:"View Details",children:e.jsxs("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})}),t.stripe_status==="active"&&e.jsx(g,{href:`/admin/subscriptions/${t.id}/cancel`,method:"patch",as:"button",className:"text-red-400 hover:text-red-300 text-sm font-medium transition-colors",title:"Cancel Subscription",onClick:A=>{confirm("Are you sure you want to cancel this subscription?")||A.preventDefault()},children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]})})]},t.id)})})]})}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"text-6xl mb-4",children:"💳"}),e.jsx("h3",{className:"text-xl font-medium text-white mb-2",children:"No subscriptions found"}),e.jsx("p",{className:"text-gray-400 mb-6",children:Object.values(r).some(t=>t&&t!=="all")?"No subscriptions match your current filters. Try adjusting your search criteria.":"No active subscriptions found in the system."}),e.jsx("div",{className:"flex justify-center gap-3",children:Object.values(r).some(t=>t&&t!=="all")&&e.jsxs("button",{onClick:()=>d.get("/admin/subscriptions"),className:"bg-gray-600 hover:bg-gray-700 text-white px-6 py-3 rounded-lg font-medium transition-all flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})}),"Clear Filters"]})})]})}),e.jsxs("div",{className:"bg-white/10 backdrop-blur-lg rounded-2xl p-6 border border-white/20",children:[e.jsxs("h4",{className:"text-lg font-semibold text-white mb-4 flex items-center",children:[e.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Subscription Management Guide"]}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-6 text-sm",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"font-semibold text-white mb-2",children:"Subscription Status:"}),e.jsxs("ul",{className:"space-y-1 text-gray-300",children:[e.jsxs("li",{children:["• ✅ ",e.jsx("strong",{children:"Active:"})," Subscription is current and paid"]}),e.jsxs("li",{children:["• 🆓 ",e.jsx("strong",{children:"Trialing:"})," In free trial period"]}),e.jsxs("li",{children:["• ⏳ ",e.jsx("strong",{children:"Incomplete:"})," Payment setup incomplete"]}),e.jsxs("li",{children:["• ⚠️ ",e.jsx("strong",{children:"Past Due:"})," Payment failed, retry in progress"]})]})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-semibold text-white mb-2",children:"Plan Types:"}),e.jsxs("ul",{className:"space-y-1 text-gray-300",children:[e.jsxs("li",{children:["• 💳 ",e.jsx("strong",{children:"Basic:"})," Standard features"]}),e.jsxs("li",{children:["• 💎 ",e.jsx("strong",{children:"Premium:"})," Enhanced features"]}),e.jsxs("li",{children:["• 🏆 ",e.jsx("strong",{children:"Professional:"})," Full access"]}),e.jsxs("li",{children:["• 🔧 ",e.jsx("strong",{children:"Custom:"})," Enterprise solutions"]})]})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-semibold text-white mb-2",children:"Quick Actions:"}),e.jsxs("ul",{className:"space-y-1 text-gray-300",children:[e.jsx("li",{children:"• Use bulk actions for multiple subscriptions"}),e.jsx("li",{children:"• Filter by status to identify issues"}),e.jsx("li",{children:"• Monitor trial conversions and renewals"})]})]})]})]})]})})}export{$ as default};
