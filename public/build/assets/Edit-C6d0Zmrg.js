import{u as P,r as k,x as S,j as e,t as u}from"./app-DKA_wRZs.js";import{C as A}from"./ClientLayout-DEKu7pz-.js";function D({auth:b,request:s}){const{success:g,error:f,info:p,warning:o}=P(),[d,x]=k.useState([]),{data:i,setData:n,patch:j,processing:h,errors:c}=S({subject:s.subject||"",description:s.description||"",contact_preference:s.contact_preference||["email"],phone:s.phone||"",preferred_visit_time:s.preferred_contact_time||"",property_access_info:s.property_access_info||"",attachments:[]}),y=t=>{const r=Array.from(t.target.files),a=s.attachments||[];if(r.length+d.length+a.length>5){o("You can upload a maximum of 5 files per service request");return}const l=r.filter(m=>m.size>10485760?(o(`File ${m.name} is too large. Maximum size is 10MB per file.`),!1):!0);x(m=>[...m,...l]),n("attachments",[...d,...l]),p(`${l.length} file(s) added successfully`)},v=t=>{const r=d.filter((a,l)=>l!==t);x(r),n("attachments",r),p("File removed from request")},N=t=>{const r=i.contact_preference||[];let a;r.includes(t)?a=r.filter(l=>l!==t):a=[...r,t],n("contact_preference",a)},w=t=>{if(t.preventDefault(),!i.subject.trim()){o("Please enter a subject for your service request");return}if(!i.description.trim()){o("Please provide details about the maintenance or repair needed");return}if(i.contact_preference.length===0){o("Please select at least one contact method");return}if(i.contact_preference.includes("phone")&&!i.phone.trim()){o("Please enter your phone number since you selected phone contact");return}p("Updating your homecare service request...");const r=new FormData;r.append("subject",i.subject),r.append("description",i.description),r.append("phone",i.phone||""),r.append("preferred_visit_time",i.preferred_visit_time||""),r.append("property_access_info",i.property_access_info||""),r.append("_method","PATCH"),i.contact_preference.forEach((a,l)=>{r.append(`contact_preference[${l}]`,a)}),d.forEach((a,l)=>{r.append(`attachments[${l}]`,a)}),j(route("requests.update",s.id),{data:r,forceFormData:!0,preserveScroll:!0,onSuccess:()=>{g("🏡 Service request updated successfully!"),x([])},onError:a=>{console.error("Form submission errors:",a),f("Failed to update service request.")}})},_=t=>({preventive_maintenance:"🔧",emergency_repair:"🚨",property_inspection:"📋",home_improvement:"🏗️",hvac_service:"❄️",plumbing_service:"🚿",electrical_service:"⚡",roofing_service:"🏠",painting_service:"🎨",landscaping_service:"🌿",security_service:"🔒",general_maintenance:"🛠️",document:"📄",appointment:"📅",medical:"🏥",technical:"🔧",billing:"💳",general:"📋"})[t]||"📋",C=t=>({submitted:"bg-blue-500/20 border-blue-500/30 text-blue-400",reviewed:"bg-yellow-500/20 border-yellow-500/30 text-yellow-400",in_progress:"bg-orange-500/20 border-orange-500/30 text-orange-400",completed:"bg-green-500/20 border-green-500/30 text-green-400",cancelled:"bg-red-500/20 border-red-500/30 text-red-400"})[t]||"bg-gray-500/20 border-gray-500/30 text-gray-400";return e.jsx(A,{title:`Edit Request - ${s.subject} - NWB`,auth:b,children:e.jsxs("div",{className:"max-w-4xl mx-auto space-y-8",children:[e.jsxs("div",{className:"relative overflow-hidden rounded-3xl",style:{background:"linear-gradient(135deg, rgba(0, 179, 186, 0.1) 0%, rgba(0, 179, 186, 0.05) 100%)"},children:[e.jsx("div",{className:"absolute inset-0 opacity-10",children:e.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 rounded-full filter blur-3xl",style:{backgroundColor:"#00b3ba"}})}),e.jsxs("div",{className:"relative p-8",children:[e.jsx("div",{className:"flex items-center gap-3 mb-4",children:e.jsx(u,{href:`/requests/${s.id}`,className:"text-blue-400 hover:text-blue-300 text-sm font-medium transition-colors",children:"← Back to Request Details"})}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-4xl font-bold text-white flex items-center gap-3 mb-3",children:[e.jsx("span",{className:"text-5xl",children:_(s.type)}),"Edit Service Request"]}),e.jsx("p",{className:"text-xl text-slate-300 mb-2",children:"Update your homecare service request details"}),e.jsxs("p",{className:"text-sm font-medium",style:{color:"#00b3ba"},children:["Request ID: REQ-",s.id.toString().padStart(6,"0")]})]}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsx("span",{className:`inline-flex items-center px-4 py-2 rounded-full text-sm font-medium border ${C(s.status)}`,children:s.status_label||s.status.charAt(0).toUpperCase()+s.status.slice(1)})})]})]})]}),e.jsxs("div",{className:"bg-white/10 backdrop-blur-lg rounded-2xl p-6 border border-white/20",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Current Request Information"}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-300",children:"Service Type:"}),e.jsx("p",{className:"text-white font-medium",children:s.type_label||s.type})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-300",children:"Priority:"}),e.jsx("p",{className:"text-white font-medium",children:s.priority_label||s.priority})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-300",children:"Property Address:"}),e.jsx("p",{className:"text-white font-medium",children:s.property_address})]})]}),e.jsx("div",{className:"mt-4 p-4 bg-yellow-500/10 border border-yellow-500/20 rounded-lg",children:e.jsxs("p",{className:"text-yellow-300 text-sm",children:[e.jsx("strong",{children:"Note:"})," Service type, priority, and property address cannot be changed after submission. If you need to modify these details, please create a new request and cancel this one."]})})]}),e.jsxs("form",{onSubmit:w,className:"bg-white/10 backdrop-blur-lg rounded-2xl p-8 border border-white/20 space-y-8",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-lg font-semibold text-white mb-3",children:"Service Subject *"}),e.jsx("input",{type:"text",value:i.subject,onChange:t=>n("subject",t.target.value),className:"w-full px-4 py-3 bg-[#232424] border border-white/30 rounded-lg text-white placeholder-gray-300 transition-all duration-300 focus:border-[#00b3ba]",placeholder:"Brief summary of the property service needed",required:!0}),c.subject&&e.jsx("p",{className:"text-red-400 text-sm mt-2",children:c.subject})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-lg font-semibold text-white mb-3",children:"Detailed Description *"}),e.jsx("textarea",{value:i.description,onChange:t=>n("description",t.target.value),rows:"6",className:"w-full px-4 py-3 bg-[#232424] border border-white/30 rounded-lg text-white placeholder-gray-300 transition-all duration-300 resize-none focus:border-[#00b3ba]",placeholder:"Please describe the property maintenance or repair needed. Include specific rooms, areas, symptoms, materials required, preferred timeline, etc.",required:!0}),e.jsxs("div",{className:"flex justify-between mt-2",children:[e.jsx("span",{className:"text-sm text-gray-400",children:"Include room locations, symptoms, materials needed, and access requirements"}),e.jsxs("span",{className:"text-sm text-gray-400",children:[i.description.length,"/2000"]})]}),c.description&&e.jsx("p",{className:"text-red-400 text-sm mt-2",children:c.description})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-lg font-semibold text-white mb-3",children:"Property Access Information"}),e.jsx("textarea",{value:i.property_access_info,onChange:t=>n("property_access_info",t.target.value),rows:"3",className:"w-full px-4 py-3 bg-[#232424] border border-white/30 rounded-lg text-white placeholder-gray-300 transition-all duration-300 resize-none focus:border-[#00b3ba]",placeholder:"Gate codes, parking instructions, key location, pet information, security system details, or any special access requirements for our technicians"}),e.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"Help our technicians access your property efficiently and safely"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-lg font-semibold text-white mb-4",children:"Preferred Contact Methods *"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[{value:"email",label:"Email Updates",icon:"📧",description:"Service confirmations & progress updates"},{value:"phone",label:"Phone Calls",icon:"📞",description:"Direct communication with technicians"},{value:"whatsapp",label:"WhatsApp",icon:"💬",description:"Real-time chat with NWB team"}].map(t=>e.jsxs("label",{className:`flex items-center p-4 rounded-xl border-2 cursor-pointer transition-all ${i.contact_preference.includes(t.value)?"text-white border-white/30":"border-white/30 bg-white/5 hover:bg-white/10"}`,style:i.contact_preference.includes(t.value)?{borderColor:"#00b3ba",backgroundColor:"rgba(0, 179, 186, 0.1)"}:{},children:[e.jsx("input",{type:"checkbox",checked:i.contact_preference.includes(t.value),onChange:()=>N(t.value),className:"sr-only"}),e.jsx("span",{className:"text-2xl mr-3",children:t.icon}),e.jsxs("div",{children:[e.jsx("div",{className:"text-white font-medium",children:t.label}),e.jsx("div",{className:"text-gray-400 text-sm",children:t.description})]})]},t.value))}),c.contact_preference&&e.jsx("p",{className:"text-red-400 text-sm mt-2",children:c.contact_preference})]}),i.contact_preference.includes("phone")&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-lg font-semibold text-white mb-3",children:"📞 Phone Number for Service Coordination"}),e.jsx("input",{type:"tel",value:i.phone,onChange:t=>n("phone",t.target.value),className:"w-full px-4 py-3 bg-[#232424] border border-white/30 rounded-lg text-white placeholder-gray-300 transition-all duration-300 focus:border-[#00b3ba]",placeholder:"Enter phone number for technician coordination"}),c.phone&&e.jsx("p",{className:"text-red-400 text-sm mt-2",children:c.phone})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-lg font-semibold text-white mb-3",children:"Preferred Service Visit Time"}),e.jsxs("select",{value:i.preferred_visit_time,onChange:t=>n("preferred_visit_time",t.target.value),className:"w-full px-4 py-3 bg-[#232424] border border-white/30 rounded-lg text-white transition-all duration-300 focus:border-[#00b3ba]",children:[e.jsx("option",{value:"",children:"Any time during business hours (8 AM - 6 PM)"}),e.jsx("option",{value:"morning",children:"Morning (8 AM - 12 PM)"}),e.jsx("option",{value:"afternoon",children:"Afternoon (12 PM - 4 PM)"}),e.jsx("option",{value:"evening",children:"Evening (4 PM - 6 PM)"}),e.jsx("option",{value:"weekend",children:"Weekend (Saturday 9 AM - 3 PM)"}),e.jsx("option",{value:"emergency",children:"Emergency - ASAP"})]}),e.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"Priority scheduling available for Premium and Deluxe subscribers"})]}),s.attachments&&s.attachments.length>0&&e.jsxs("div",{children:[e.jsxs("label",{className:"block text-lg font-semibold text-white mb-3",children:["Current Attachments (",s.attachments.length,")"]}),e.jsx("div",{className:"space-y-2 mb-4",children:s.attachments.map((t,r)=>{const a=typeof t=="object"?t.original_name||t.filename:t;return e.jsxs("div",{className:"flex items-center justify-between bg-white/10 p-3 rounded-lg",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"text-lg mr-2",children:"📄"}),e.jsx("span",{className:"text-white text-sm",children:a}),typeof t=="object"&&t.size&&e.jsxs("span",{className:"text-gray-400 text-xs ml-2",children:["(",(t.size/1024/1024).toFixed(1),"MB)"]})]}),e.jsx("span",{className:"text-gray-400 text-sm",children:"Existing file"})]},r)})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-lg font-semibold text-white mb-3",children:"Add New Property Photos & Documents"}),e.jsxs("div",{className:"border-2 border-dashed border-white/30 rounded-lg p-6 text-center hover:border-white/50 transition-colors",children:[e.jsx("input",{type:"file",multiple:!0,onChange:y,className:"hidden",id:"file-upload",accept:".pdf,.doc,.docx,.jpg,.jpeg,.png,.gif,.heic"}),e.jsxs("label",{htmlFor:"file-upload",className:"cursor-pointer",children:[e.jsx("div",{className:"text-4xl mb-2",children:"📸"}),e.jsx("p",{className:"text-white font-medium mb-1",children:"Upload Additional Photos or Documents"}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Add more photos or documents to help our technicians. Supports PDF, DOC, JPG, PNG, HEIC up to 10MB each (max 5 files total)"})]})]}),d.length>0&&e.jsxs("div",{className:"mt-4 space-y-2",children:[e.jsx("p",{className:"text-white font-medium",children:"New Files to Add:"}),d.map((t,r)=>e.jsxs("div",{className:"flex items-center justify-between bg-white/10 p-3 rounded-lg",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"text-lg mr-2",children:"📄"}),e.jsx("span",{className:"text-white text-sm",children:t.name}),e.jsxs("span",{className:"text-gray-400 text-xs ml-2",children:["(",(t.size/1024/1024).toFixed(1),"MB)"]})]}),e.jsx("button",{type:"button",onClick:()=>v(r),className:"text-red-400 hover:text-red-300 transition-colors",children:"✕"})]},r))]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 pt-6",children:[e.jsx(u,{href:`/requests/${s.id}`,className:"flex-1 text-center text-white px-6 py-3 rounded-lg font-medium transition-all duration-300 bg-gray-600 hover:bg-gray-700",children:"Cancel Changes"}),e.jsx("button",{type:"submit",disabled:h,className:"flex-1 text-white px-6 py-3 rounded-lg font-medium transition-all transform hover:scale-105 disabled:opacity-50 disabled:transform-none shadow-lg",style:{backgroundColor:"#00b3ba"},children:h?e.jsxs("span",{className:"flex items-center justify-center",children:[e.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Updating Request..."]}):e.jsxs("span",{className:"flex items-center justify-center",children:["Update Service Request",e.jsx("span",{className:"ml-2",children:"🏡"})]})})]})]}),e.jsxs("div",{className:"bg-white/10 backdrop-blur-lg rounded-2xl p-6 border border-white/20",children:[e.jsxs("h3",{className:"text-lg font-semibold text-white mb-3 flex items-center",children:[e.jsx("span",{className:"mr-2",children:"💡"}),"Editing Guidelines"]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("ul",{className:"text-gray-300 space-y-2 text-sm",children:[e.jsx("li",{children:"• Service type and priority cannot be changed after submission"}),e.jsx("li",{children:"• Property address is locked to ensure proper service routing"}),e.jsx("li",{children:"• You can update description to add more details"}),e.jsx("li",{children:"• Contact preferences can be modified anytime"})]}),e.jsxs("ul",{className:"text-gray-300 space-y-2 text-sm",children:[e.jsx("li",{children:"• New attachments will be added to existing ones"}),e.jsx("li",{children:"• Existing files cannot be removed (contact support if needed)"}),e.jsx("li",{children:"• Changes are only allowed while request is submitted/reviewed"}),e.jsx("li",{children:"• Updates will refresh the estimated completion time"})]})]})]})]})})}export{D as default};
